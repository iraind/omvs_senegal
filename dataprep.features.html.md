# Feature and Targets


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

------------------------------------------------------------------------

<a
href="https://github.com/iraind/omvs_senegal/blob/main/omvs_senegal/data/features.py#L13"
target="_blank" style="float:right; font-size:smaller">source</a>

### FeatureAndTargetGenerator

>  FeatureAndTargetGenerator (context_len:int=10, target_len:int=10,
>                                 poly_degree:int=1)

*Transforms time series data into feature matrices suitable for machine
learning models. Creates lagged features using a sliding window and
optionally generates polynomial features to capture non-linear
relationships between variables. It also creates a target vector for the
number of timesteps to predict.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>context_len</td>
<td>int</td>
<td>10</td>
<td>number of previous timesteps to use as features</td>
</tr>
<tr>
<td>target_len</td>
<td>int</td>
<td>10</td>
<td>number of timesteps to predict</td>
</tr>
<tr>
<td>poly_degree</td>
<td>int</td>
<td>1</td>
<td>degree of polynomial features</td>
</tr>
</tbody>
</table>

We will first open the data

``` python
DATA_PATH = Path("../testing_data")

data = pd.read_csv(
    DATA_PATH/'hydro_example.csv', 
    usecols=['time', 'smoothed_rain', 'Q_mgb', 'Q_obs'], 
    index_col='time',
    converters={"time": pd.to_datetime}
    )
```

Then we need to create an instance of the generator setting the context
and the target length and the polynomial degree.

``` python
generator = FeatureAndTargetGenerator(context_len=1, target_len=2, poly_degree=2)
```

Then we can generate the feature and target matrixes as follows

------------------------------------------------------------------------

<a
href="https://github.com/iraind/omvs_senegal/blob/main/omvs_senegal/data/features.py#L29"
target="_blank" style="float:right; font-size:smaller">source</a>

### FeatureAndTargetGenerator.generate

>  FeatureAndTargetGenerator.generate (df:pandas.core.frame.DataFrame,
>                                          x_col:list[str], y_col:list[str])

*Generates a feature matrix and target vector from the input data.*

``` python
x_col, y_col = ['smoothed_rain','Q_mgb'], ['Q_obs']
data_x, data_y = generator.generate(data, x_col=x_col, y_col=y_col)
```

The generated data will look as follows

``` python
data_x.head(3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">2012-01-01</td>
<td>1.0</td>
<td>0.299868</td>
<td>15.22</td>
<td>0.089921</td>
<td>4.563995</td>
<td>231.6484</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2012-01-02</td>
<td>1.0</td>
<td>0.299767</td>
<td>14.84</td>
<td>0.089860</td>
<td>4.448548</td>
<td>220.2256</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2012-01-03</td>
<td>1.0</td>
<td>0.265321</td>
<td>14.48</td>
<td>0.070395</td>
<td>3.841846</td>
<td>209.6704</td>
</tr>
</tbody>
</table>

</div>

``` python
data_y.head(3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">t+1</th>
<th data-quarto-table-cell-role="th">t+2</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">2012-01-01</td>
<td>67.500000</td>
<td>67.349998</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2012-01-02</td>
<td>67.349998</td>
<td>66.800003</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2012-01-03</td>
<td>66.800003</td>
<td>66.739998</td>
</tr>
</tbody>
</table>

</div>
